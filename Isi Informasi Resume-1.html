<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Isi Informasi Resume</title>
  <!-- Bootstrap連結 -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.0/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-KyZXEAg3QhqLMpG8r+8fhAXLRk2vvoC2f3B09zVXn8CA5QIVfZOJ3BCsw2P0p/We" crossorigin="anonymous">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.0/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-U1DAWAznBHeqEIlVSCgzq+c9gqGAJn5c/t99JyeKa9xxaYpSvHU5awsuZVVFIhvj"
    crossorigin="anonymous"></script>

  <!-- CSS連結 -->
  <link rel="stylesheet" href="Isi Informasi Resume.css">

  <!--JQuery 連結-->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
  <!--SimplePagenation 連結-->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/simplePagination.js/1.6/jquery.simplePagination.min.js"></script>
</head>


<body>

  <div style="width: auto; height: auto;" class="container-fluid">
    <h1 style="font-size: 25px; color: floralwhite;text-align: center;"><b>Isi Informasi Resume</b></h1>

    <div class="containerN" style="background-color: hsl(102, 70%, 50%);font-size: 14px;height: 140PX;width: 85%;">
      <label style="margin-left: 10px;color: red;"><b>* No.Induk</b></label>
      <input class="form-control" style="background-color:#eec07c;width: 45%;margin-left: 10px;" type="text" id="code"
        required>
      <label style="margin-left: 10px;color: red;"></b>* Nama</b></label>
      <input class="form-control" style="background-color:#eec07c;width: 85%;margin-left: 10px;margin-bottom: 10px;" type="text" id="name"
        required>
    </div>

    <br>
    <label
      style="font-size:20px;color: hsl(61, 93%, 49%);background-color: rgb(246, 9, 9);margin-top: 10px;width:55%;height: 35px;text-align: center;">Informasi
      pribadi dasar</label>
    <br>
    <div style="margin-left: 10px;">

      <label><b>*Tgl.lahir</b></label>
      <input class="form-control" style="background-color:blanchedalmond;" type="date" id="bhd" required>
      <label><b>*Umur</b></label>
      <br>
      <input class="form-control d-inline-block" style="background-color:blanchedalmond; width: 55px;" type="number"
        id="age" required>
      <label>tahun</label>
      <br>
      <label for="bhp"><b>*Tempat lahir</b></label>
      <br>
      <input class="form-control" style="background-color:blanchedalmond;" type="text" id="bhp" required>
      <label for="weight"><b>*Berat badan</b></label>
      <br>
      <input class="form-control d-inline-block" style="background-color:blanchedalmond; width: 70px;" type="number"
        id="weight" required>
      <label class="ms-0">kg.</label>
      <br>
      <label for="height"><b>*Tinggi Badan</b></label>
      <br>
      <input class="form-control d-inline-block" style="background-color:blanchedalmond; width:80px;" type="number"
        id="height" required>
      <label class="ms-0">cm.</label>
      <br>
      <label><b>*Dimana kamu saat ini</b></label>
      <select class="form-select" style="background-color:blanchedalmond;" id="FCTY">
        <option value="IND">Indonesia</option>
        <option value="TWN">Taiwan</option>
        <option value="HKG">Hongkong</option>
        <option value="SNG">Singapura</option>
        <!-- 其他選項省略 -->
      </select>

      <label for="edu"><b>*Pendidikan</b></label>
      <select class="form-select" style="background-color:blanchedalmond;" id="edu">
        <option value="小學">SD</option>
        <option value="國中" selected>SMP/SLTP</option>
        <option value="高中">SMA/SLTA/SMK</option>
        <option value="大學">D3/S1</option>
      </select>

      <label for="reg"><b>*Agama</b></label>
      <select class="form-select" style="background-color:blanchedalmond;" id="reg">
        <option value="回教" selected>Islam</option>
        <option value="天主教">Katolik</option>
        <option value="基督教">Keristenan</option>
        <option value="佛教">Buddha</option>
        <option value="印度教">Hinduisme</option>
      </select>

      <label for="sex"><b>*Jenis Kelamin</b></label>
      <select class="form-select" style="background-color:blanchedalmond;" id="sex">
        <option value="male">Pria</option>
        <option value="female" selected>Perempuan</option>
      </select>

      <label><b>Jumlah Saudara</b></label>
      <input class="form-control" style="width: 130px;" type="text" id="bsn" required>

      <label><b>Anak Ke</b></label>
      <input class="form-control" style="width: 130px;" type="text" id="rng" required>

      <label><b>Nomor Paspor</b></label>
      <input class="form-control" style="width: 150px;" type="text" id="pasno">

      <label><b>Foto Setengah Panjang :</b></label>
      <input class="form-control" style="width:  85%;" type="file" id="image1">

      <label><b>Pengenalan Diri MP4 :</b></label>
      <input class="form-control" style="width: 85%;" type="file" id="self">
      <br>
      <label style="font-size:20px;color: hsl(61, 93%, 49%);background-color: rgb(246, 9, 9);margin-top: 10px;width:55%;height: 35px;text-align: center;"><b>Status Perkawinan</b></label><br>
      <select id="mrg" size="4">
        <option value="未婚" selected>Belum Kawin</option>
        <option value="已婚">Kawin</option>
        <option value="離婚">Cera</option>
        <option value="寡居">Janda</option>
      </select>
      <br>
      <label><b>Nama Pasangan</b></label><br>
      <input type="text" id="hsbname" required>
      <br>
      <label style="margin-top: 10px;"><b>Umur Pasangan</b></label>
      <br>
      <input type="text" id="hsbage" required>
      <br>
      <label style="margin-top: 10px;" for="hsbjob"><b>Pekerjaan Pasangan</b></label>
      <br>
      <select id="hsbjob" size="4">
        <option value="農夫">Petani</option>
        <option value="家庭主婦">Ibu rumah tangga</option>
        <option value="上班">Bekerja</option>
        <option value="開店">Buka toko</option>
        <option value="工廠工作">Pabrik kerja</option>
      </select>
      <br>
      <label for="childn"><b>Jumlah Anak</b></label><br>
      <input type="text" id="childn">
      <br>
      <label for="childb"><b>Umur Anak Sulung</b></label><br>
      <input type="text" id="childb">
      <br>
      <label><b>Umur Anak Bungsu</b></label>
      <br>
      <input style="margin-bottom: 15px;" type="text" id="childl">
      <br>
      <label style="font-size:20px;color: hsl(61, 93%, 49%);background-color: rgb(246, 9, 9);margin-top: 10px;width:55%;height: 35px;text-align: center;"><b>Pengalaman kerja</b></label><br>
      <label style="color: hwb(124 0% 95%);background-color: #f47738;margin-top: 10px;width:35%;height: 25px;text-align: center;" id="exp1"><b>Pengalaman Kerja 1:</b></label>
      <br>
      <label><b>Mulai Danggal</b></label><br>
      <input id="startDay1" type="month" placeholder="tanggal mulai" class="form-controlday">
      <br>
      <label><b>Tanggal khir</b></label><br>
      <input id="finishDay1" type="month" placeholder="tanggal akhir" class="form-controlday">
      <br>
      <label><b>Tempat Kerja</b></label>
        <select id="place1" size="5" class="form-select">
          <option value="當地">Indonesia</option>
          <option value="台灣">Taiwan</option>
          <option value="新加坡">Singapura</option>
          <option value="馬來西亞">Malaysia</option>
          <option value="香港">Hongkong</option>
          <option value="澳門">Macao</option>
          <option value="阿拉伯">Arab</option>
          <option value="韓國">Korea</option>
          <option value="汶萊">Brunai</option>
          <option value="日本">Jepan</option>
        </select>
        <label><b>Konten Pekerjaan</b></label><br>
        <textarea style="height: 120px;width: auto;" id="job1ds"></textarea>
        <br>
        <label><b>Alasan Untuk Pergi</b></label>
        <select style="width:250px;" id="finishReason1" size="5" class="form-select">
          <option value="合約到期">kontrak telah habis</option>
          <option value="家裡有事">Sesuatu terjadi di rumah</option>
          <option value="結婚">nikah</option>
          <option value="要到台灣工作">Ingin bekerja di Taiwan</option>
          <option value="被照顧人往生">Orang yang dirawat meninggal dunia</option>
        </select>
        <label style="color: hwb(124 0% 95%);background-color: #f47738;margin-top: 10px;width:35%;height: 25px;text-align: center;" id="exp2"><b>Pengalaman Kerja 2:</b></label>
        <br>
        <label><b>Mulai Danggal</b></label>
        <br>
        <input id="startDay2" type="month" placeholder="tanggal mulai" class="form-controlday">
        <br>
        <label><b>Tangga2 khir</b></label>
        <br>
        <input id="finishDay2" type="month" placeholder="tanggal akhir" class="form-controlday">
        <br>
        <label><b>Tempat Kerja</b></label>
        <select id="place2" size="5" class="form-select">
          <option value="當地">Indonesia</option>
          <option value="台灣">Taiwan</option>
          <option value="新加坡">Singapura</option>
          <option value="馬來西亞">Malaysia</option>
          <option value="香港">Hongkong</option>
          <option value="澳門">Macao</option>
          <option value="阿拉伯">Arab</option>
          <option value="韓國">Korea</option>
          <option value="汶萊">Brunai</option>
          <option value="日本">Jepan</option>
        </select>
        <label><b>Konten pekerjaan</b></label>
        <br>
        <textarea style="height: 120px;" id="job2ds"></textarea>
        <br>
        <label><b>Alasan untuk pergi<b></label>
        <br>
        <select style="margin-bottom: 15px; width: 320px;" id="finishReason2" size="5" class="form-select">
          <option value="合約到期">kontrak telah habis</option>
          <option value="家裡有事">Sesuatu terjadi di rumah</option>
          <option value="結婚">nikah</option>
          <option value="要到台灣工作">Ingin bekerja di Taiwan</option>
          <option value="被照顧人往生">Orang yang dirawat meninggal dunia</option>
        </select>
        <br>
      </div>
      <button style="margin-bottom: 15px; height: 45px; width: 100%; background-color: hwb(34 8% 2%);font-size: 20px;"
        id="Sumit" onclick="sendData()"><b>Sumit</b>
      </button>
      <!--
        <p id="progressMessage"></p>
        <p id="errorMessage"></p>
       -->

      <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
      <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-database-compat.js"></script>
      <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-storage-compat.js"></script>
      <!-- 引入 Firebase 配置 -->
      <script src="firebaseConfig.js"></script>

      <script>

        document.addEventListener("DOMContentLoaded", function () {
          // 選擇所有的 tab 按鈕
          const tabButtons = document.querySelectorAll(".nav-link");

          // 對每個按鈕綁定點擊事件
          tabButtons.forEach(button => {
            button.addEventListener("click", function () {
              // 移除其他按鈕的 active 樣式
              tabButtons.forEach(btn => btn.classList.remove("active"));

              // 對當前點擊的按鈕添加 active 樣式
              this.classList.add("active");
            });
          });
        });

        // Initialize Firebase
        firebase.initializeApp(firebaseConfigJOBSCRIPT, "dbJOB");
        const database1 = firebase.database(firebase.app("dbJOB"));
        const storage = firebase.storage(firebase.app("dbJOB"));

        function sendData() {

          const code = document.getElementById('code').value;
          const name = document.getElementById('name').value;
          const bhd = document.getElementById('bhd').value;
          const bhp = document.getElementById('bhp').value;
          const age = document.getElementById('age').value;
          const weight = document.getElementById('weight').value;
          const height = document.getElementById('height').value;
          const FCTY = document.getElementById('FCTY').value;
          const mrg = document.getElementById('mrg').value;
          const edu = document.getElementById('edu').value;
          const reg = document.getElementById('reg').value;
          const bsn = document.getElementById('bsn').value;
          const rng = document.getElementById('rng').value;
          const hsbname = document.getElementById('hsbname').value;
          const hsbage = document.getElementById('hsbage').value;
          const hsbjob = document.getElementById('hsbjob').value;
          const childn = document.getElementById('childn').value;
          const childb = document.getElementById('childb').value;
          const childl = document.getElementById('childl').value;
          const firebaseIndex = document.getElementById('code').value;
          const pasno = document.getElementById('pasno').value;
          var startDate1 = document.getElementById("startDay1").value;
          var finishDate1 = document.getElementById("finishDay1").value;
          var place1 = document.getElementById("place1").value;
          var jobContent1 = document.getElementById("job1ds").value;
          var finishReason1 = document.getElementById("finishReason1").value;
          var exp1 = '';
          // 檢查是否有填寫資料
          if (place1 && jobContent1 && finishReason1) {
            // 生成文字內容
            var resultText = startDate1 + " ~ " + finishDate1 + "\n" + "工作地點: " + place1 +
              "\n" + "工作內容: " + jobContent1 + "\n" + "離職原因: " + finishReason1;
            // 將生成的文字內容添加到保存所有工作經驗的變量中
            exp1 = resultText;
          }

          var startDate2 = document.getElementById("startDay2").value;
          var finishDate2 = document.getElementById("finishDay2").value;
          var place2 = document.getElementById("place2").value;
          var jobContent2 = document.getElementById("job2ds").value;
          var finishReason2 = document.getElementById("finishReason2").value;
          var exp2 = '';

          // 檢查是否有填寫資料
          if (place2 && jobContent2 && finishReason2) {
            // 生成文字內容
            var resultText2 = startDate2 + " ~ " + finishDate2 + "\n" + " 地點: " + place2 +
              "\n工作內容: " + jobContent2 + " \n離職原因: " + finishReason2;
            exp2 = resultText2;
          }

          const sex = document.getElementById("sex").value;

          // 獲取所有已勾選的工作專長
          //const selectedPro = [];
          //const checkboxes = document.querySelectorAll('input[name="pro"]:checked');
          //checkboxes.forEach((checkbox) => {
          //   selectedPro.push(checkbox.value);
          //});

          // 检查输入是否有效
          if (!code || !name || !bhd || !age || !height || !weight || !FCTY || !mrg || !edu || !sex) {
            // 如果有任何输入为空，阻止表单提交
            alert('Silakan isi semua bidang yang wajib diisi.\n\nNo.Induk\nNama \nTgl.lahir\nUmur\nTempat lahir\nBerat badan\nTinggi Badan\npilih tujuan anda bekerja');
            return false; // 阻止表单提交
          }
          // 現在在給定的路徑上將數據設置到數據庫中
          const userData = {
            code: code,
            name: name,
            bhd: bhd,
            bhp: bhp,
            age: age,
            weight: weight,
            height: height,
            FCTY: FCTY,
            mrg: mrg,
            edu: edu,
            reg: reg,
            bsn: bsn,
            rng: rng,
            hsbname: hsbname,
            hsbage: hsbage,
            hsbjob: hsbjob,
            childn: childn,
            childb: childb,
            childl: childl,
            exp1: exp1,
            exp2: exp2,
            sex: sex,
            pasno: pasno
          };
          // 將資料同時寫入到兩個 Firebase 數據庫
          //  db1Ref.push(userData)
          const selectedOption = document.getElementById('FCTY').value;

          database1.ref('KFA/' + firebaseIndex).set(userData)
          // 調用上傳文件的函數
          uploadFiles();
        }

        function uploadFiles() {
          uploadFile('image1', 'image1');
          uploadFile('image2', 'image2');
          uploadFile('self', 'self');
        }

        function uploadFile(inputId, storagePath) {
          const fileInput = document.getElementById(inputId);
          const file = fileInput.files[0];

          const storageRef = storage.ref();
          const uploadTask = storageRef.child(storagePath + '/' + code.value).put(file);

          uploadTask.on('state_changed',
            (snapshot) => {
              // 進度更新
              const progress = (snapshot.bytesTransferred / snapshot.totalBytes) * 100;
              const roundedProgress = Math.round(progress);  // 四捨五入進度為整數
              progressMessage.textContent = `Upload is ${roundedProgress}% done`;
            },
            (error) => {
              // 上傳失敗
              console.error('Upload failed:', error);
            },
            () => {
              // 上傳完成
              uploadTask.snapshot.ref.getDownloadURL().then((downloadURL) => {
                saveFileUrl(storagePath, code, downloadURL);
                // 恢復進度訊息
                progressMessage.textContent = "Upload completed";

                // 這裡可以設置為原始狀態，例如空白
                setTimeout(() => {
                  progressMessage.textContent = "";
                  //document.getElementById('code').value = '';
                }, 5000);  // 3秒後清空進度顯示
              });
            }
          );
        }

        function saveFileUrl(path, code, url) {
          //const abc = document.getElementById('code').value;
          console.log(code.value);
          const fileRef = database1.ref('KFA/' + code.value + '/' + path);
          fileRef.set(url);

          // Clear the form
          //document.getElementById('code').value = '';
          document.getElementById('name').value = '';
          document.getElementById('bhd').value = '';
          document.getElementById('age').value = '';
          document.getElementById('bhp').value = '';
          document.getElementById('weight').value = '';
          document.getElementById('height').value = '';
          document.getElementById('FCTY').value = '';
          document.getElementById('bsn').value = '';
          document.getElementById('rng').value = '';

          document.getElementById('hsbname').value = '';
          document.getElementById('hsbage').value = '';
          document.getElementById('hsbjob').value = '';
          document.getElementById('childn').value = '';
          document.getElementById('childb').value = '';
          document.getElementById('childl').value = '';

          document.getElementById("startDay1").value = '';
          document.getElementById("finishDay1").value = '';
          document.getElementById("job1ds").value = '';
          document.getElementById("startDay2").value = '';
          document.getElementById("finishDay2").value = '';
          document.getElementById("job2ds").value = '';
          document.getElementById("pasno").value = ''
        }


      </script>
</body>

</html>
